import t from"fs";import a from"http-errors";import e from"fs/promises";import E from"path";var r,n,s,i,I;!function(t){t[t.OK=200]="OK",t[t.BAD_REQUEST=400]="BAD_REQUEST",t[t.UNAUTHORIZED=401]="UNAUTHORIZED",t[t.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",t[t.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",t[t.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",t[t.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",t[t.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",t[t.NOT_ENOUGH_TOKENS=424]="NOT_ENOUGH_TOKENS"}(r||(r={})),function(t){t[t.ANIME=21]="ANIME",t[t.PORTRAIT=26]="PORTRAIT",t[t.IMAGINE_V1=27]="IMAGINE_V1",t[t.IMAGINE_V3=28]="IMAGINE_V3",t[t.REALISTIC=29]="REALISTIC",t[t.IMAGINE_V4=30]="IMAGINE_V4",t[t.IMAGINE_V4_CREATIVE=31]="IMAGINE_V4_CREATIVE",t[t.IMAGINE_V4_1=32]="IMAGINE_V4_1",t[t.IMAGINE_V5=33]="IMAGINE_V5",t[t.DELIBERATE=100]="DELIBERATE",t[t.MAGIC_MIX=101]="MAGIC_MIX",t[t.DISNEY=102]="DISNEY",t[t.ABYSS_ORANGE_MIX=103]="ABYSS_ORANGE_MIX",t[t.LYRIEL=104]="LYRIEL",t[t.RPG_4=105]="RPG_4",t[t.REALISTIC_VISION=110]="REALISTIC_VISION",t[t.DREAM_SHAPER=111]="DREAM_SHAPER",t[t.REV_ANIMATED=112]="REV_ANIMATED",t[t.TOON_YOU=113]="TOON_YOU",t[t.UNREAL_ENGINE_5=114]="UNREAL_ENGINE_5",t[t.EPIC_REALISM=115]="EPIC_REALISM",t[t.MEINA_MIX=116]="MEINA_MIX",t[t.XX_MIX_9_REALISTIC=117]="XX_MIX_9_REALISTIC",t[t.THREE_D_RENDERING=118]="THREE_D_RENDERING",t[t.ABSOLUTE_REALITY_V1_6=119]="ABSOLUTE_REALITY_V1_6"}(n||(n={})),function(t){t[t.ANIME=21]="ANIME",t[t.PORTRAIT=26]="PORTRAIT",t[t.IMAGINE_V1=27]="IMAGINE_V1",t[t.IMAGINE_V3=28]="IMAGINE_V3",t[t.REALISTIC=29]="REALISTIC",t[t.IMAGINE_V4=30]="IMAGINE_V4",t[t.IMAGINE_V4_CREATIVE=31]="IMAGINE_V4_CREATIVE",t[t.IMAGINE_V4_1=32]="IMAGINE_V4_1",t[t.IMAGINE_V5=33]="IMAGINE_V5",t[t.DELIBERATE=100]="DELIBERATE",t[t.MAGIC_MIX=101]="MAGIC_MIX",t[t.DISNEY=102]="DISNEY",t[t.ABYSS_ORANGE_MIX=103]="ABYSS_ORANGE_MIX",t[t.LYRIEL=104]="LYRIEL",t[t.RPG_4=105]="RPG_4",t[t.REALISTIC_VISION=110]="REALISTIC_VISION",t[t.DREAM_SHAPER=111]="DREAM_SHAPER",t[t.REV_ANIMATED=112]="REV_ANIMATED",t[t.TOON_YOU=113]="TOON_YOU",t[t.UNREAL_ENGINE_5=114]="UNREAL_ENGINE_5",t[t.EPIC_REALISM=115]="EPIC_REALISM",t[t.MEINA_MIX=116]="MEINA_MIX",t[t.XX_MIX_9_REALISTIC=117]="XX_MIX_9_REALISTIC",t[t.THREE_D_RENDERING=118]="THREE_D_RENDERING",t[t.ABSOLUTE_REALITY_V1_6=119]="ABSOLUTE_REALITY_V1_6"}(s||(s={})),function(t){t[t.ANIME=21]="ANIME",t[t.IMAGINE_V1=22]="IMAGINE_V1",t[t.REALISTIC=29]="REALISTIC"}(i||(i={})),function(t){t[t.REALISM=1]="REALISM"}(I||(I={}));const _=a=>{const e=()=>Buffer.from(a).toString("base64");return{base64:e,asImageSrc:()=>`data:image/png;base64,${e()}`,buffer:()=>a,blob:()=>new Blob([a],{type:"image/png"}),asFile:e=>(t.writeFileSync(e,Buffer.from(a)),new File([a],e,{type:"image/png"}))}},o=t=>a(422,t),A=t=>a(404,t),R=(t,e)=>a(t,e),N=(t,a)=>({status:()=>a,data:()=>null,getOrThrow:()=>{throw R(a,`Response data is not available in the response object. Status Response: ${a}`)},getOrElse:t=>t,errorOrThrow:()=>t}),u=t=>({status:()=>r.OK,data:()=>t,getOrThrow:()=>t,getOrElse:a=>t,errorOrThrow:()=>{throw R(r.OK,`Response data is not available in the response object. Status Response: ${r.OK}`)}});class g{constructor(){this.data=void 0,this.data=new FormData}integer(t,a,e){var E;if(null==(a=null!=(E=a)?E:e))return this;if(!Number.isInteger(a))throw o(`${t} must be an integer`);return this.data.append(t,a.toString()),this}float(t,a,e){var E;if(null==(a=null!=(E=a)?E:e))return this;if(Number.isNaN(a))throw o(`${t} must be a number`);return this.data.append(t,a.toString()),this}string(t,a,e){var E;return null==(a=null!=(E=a)?E:e)||this.data.append(t,a),this}blob(t,a,e){var E;return null==(a=null!=(E=a)?E:e)||this.data.append(t,a),this}boolean(t,a,e){var E;return null==(a=null!=(E=a)?E:e)||this.data.append(t,a.toString()),this}build(){return this.data}}const l=t=>async(a,e)=>await(async(t,a,e={})=>{const E=(new g).string("prompt",a).string("aspect_ratio",e.aspectRatio).integer("style_id",e.style,n.IMAGINE_V1).string("negative_prompt",e.negativePrompt).float("cfg",e.cfg).integer("seed",e.seed).integer("steps",e.steps).integer("high_res_results",e.highResolution?1:null).build(),s=await t.fetch("v1/imagine/api/generations",E);if(s.status!==r.OK)return N(await s.data.json(),s.status);const i=_(await s.data.arrayBuffer());return u(i)})(t,a,e),T=async t=>{try{let a;return a="string"==typeof t?t.startsWith("http")||t.startsWith("https")?await(async t=>{try{const a=await fetch(t);if(!a.ok)throw R(a.status,`Failed to fetch image ${t}: ${a.statusText}`);return await a.blob()}catch(a){throw A(`Error fetching image ${t}: ${a.message}`)}})(t):await(async t=>{try{E.isAbsolute(t)||(t=E.relative(process.cwd(),t));const a=await e.readFile(t),r=new Uint8Array(a).buffer;return new Blob([r],{type:"image/jpeg"})}catch(a){throw A(`Error reading local file ${t}: ${a.message}`)}})(t):t,a}catch(t){throw R(t.status,t.message)}},c=t=>async(a,e,E,n)=>await(async(t,a,e,E,n={})=>{const s=(new g).string("prompt",a).blob("image",await T(e)).blob("mask",await T(E)).integer("style_id",I.REALISM).float("cfg",n.cfg).string("neg_prompt",n.negativePrompt).float("inpaint_strength",n.inPaintStrength).build(),i=await t.fetch("v1/imagine/api/edits/inpaint",s);if(i.status!==r.OK)return N(await i.data.json(),i.status);const o=_(await i.data.arrayBuffer());return u(o)})(t,a,e,E,n),p=t=>async(a,e,E)=>await(async(t,a,e,E={})=>{const n=(new g).string("prompt",a).blob("image",await T(e)).integer("style_id",E.style,i.IMAGINE_V1).integer("seed",E.seed).integer("steps",E.steps).integer("strength",E.strength).string("control",E.control).float("cfg",E.cfg).string("negative_prompt",E.negativePrompt).build(),s=await t.fetch("v1/imagine/api/edits/remix",n);if(s.status!==r.OK)return N(await s.data.json(),s.status);const I=_(await s.data.arrayBuffer());return u(I)})(t,a,e,E),M=t=>async a=>await(async(t,a)=>{const e=(new g).integer("model_version",1).blob("image",await T(a)).build(),E=await t.fetch("v1/imagine/api/upscale",e);if(E.status!==r.OK)return N(await E.data.json(),E.status);const n=_(await E.data.arrayBuffer());return u(n)})(t,a),S=t=>async(a,e,E)=>await(async(t,a,e,E={})=>{var n;const i=(new g).string("prompt",a).blob("image",await T(e)).integer("style_id",null!=(n=E.style)?n:s.IMAGINE_V1).integer("seed",E.seed).integer("steps",E.steps).integer("strength",E.strength).float("cfg",E.cfg).string("negative_prompt",E.negativePrompt).build(),I=await t.fetch("v1/imagine/api/generations/variations",i);if(I.status!==r.OK)return N(await I.data.json(),I.status);const o=_(await I.data.arrayBuffer());return u(o)})(t,a,e,E);var O,f;!function(t){t.ONE_BY_ONE="1:1",t.FOUR_BY_THREE="4:3",t.THREE_BY_FOUR="3:4",t.THREE_BY_TWO="3:2",t.TWO_BY_THREE="2:3",t.SIXTEEN_BY_NINE="16:9",t.NINE_BY_SIXTEEN="9:16",t.FIVE_BY_FOUR="5:4",t.FOUR_BY_FIVE="4:5",t.EIGHT_BY_TEN="8:10",t.THREE_BY_ONE="3:1"}(O||(O={})),function(t){t.OPENPOSE="openpose",t.SCRIBBLE="scribble",t.CANNY="canny",t.LINEART="lineart",t.DEPTH="depth"}(f||(f={}));const h=(t,a)=>{var e;const E=null!=(e=null==a?void 0:a.client)?e:((t,a)=>({fetch:async(t,e)=>{const E=`https://api.vyro.ai/${t}`,r={method:"POST",body:e,headers:{Authorization:`Bearer ${a}`}},n=await fetch(E,r);return{status:n.status,data:n}}}))(0,t);return{generations:l(E),variations:S(E),remix:p(E),upscale:M(E),inpaint:c(E)}};export{O as GenerationAspectRatio,n as GenerationStyle,I as InpaintStyle,f as RemixControl,i as RemixStyle,r as Status,s as VariationStyle,h as client,h as default};
